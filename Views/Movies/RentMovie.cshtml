@model IEnumerable<CineMovie.Models.Movie>

@if (Model != null)
{
    if (Model.Count() > 0)
    {
        <div class="row">
            @foreach (var movie in Model)
            {
                <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12 mb-4">
                    <div class="card h-100">
                        <img src="@movie.Poster" class="card-img-top w-100" alt="Image not found">
                        <div class="card-body d-flex align-items-end">
                            <button data-moviename="@movie.Title" data-movieid="@movie.ImdbID" class="btnAddCart btn mt-auto btn-sm btn-block btn-amber mt-auto">Add to cart <i style="transform: rotate(-30deg)" class="ml-1 fas fa-shopping-cart"></i></button>
                        </div>
                        <div class="card-footer">
                            <small class="text-muted">
                                Rent price: @movie.RentPrice.ToString("C", System.Globalization.CultureInfo.CurrentCulture)
                            </small>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
}

@section scripts
{
    <script>
        $(document).on('click', '.btnAddCart', function () {

            const movieid = $(this).data('movieid');
            const moviename = $(this).data('moviename');

            $.post('@Url.Action("AddMovieToCart")', { movieid: movieid, moviename: moviename }, function (data) {
                if (data == 'exist') {
                    alert("Movie already exist in your cart")
                } else {
                    alert(data + " was added to cart");
                }
            }).fail(function () {

            })
        });
    </script>
}